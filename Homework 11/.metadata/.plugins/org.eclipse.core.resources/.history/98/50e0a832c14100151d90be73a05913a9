import java.util.Iterator;

public class Deq<E> implements Iterator<E> {
	private class Node<E> {
		public Node<E> left, right;
	    private final E item;

	    public Node(E item) {
	      if (item == null) { 
	    	  throw new NullPointerException();
	      }
	      
	      this.item = item;
	      this.right = null;
	    }
	    
	    public Node(E item, Node<E> prevElem) {
		      if (item == null) { 
		    	  throw new NullPointerException();
		      }
		      
		      this.item = item;
		      prevElem.right = this;
		      this.right = null;
		}
	    
	    public Node(Node<E> nextElem, E item) {
		      if (item == null) { 
		    	  throw new NullPointerException();
		      }
		      
		      this.item = item;
		      nextElem.left = this;
		      this.left = null;
		}
	}
	
	 private Node head;
	 private Node tail;
	 private int count;
	 
	 public Deq() {
		 this.head = null;
		 this.tail = null;
		 this.count = 0;
	 }
	 
	 public void addFirst(E item) {
		 if (head == null) {
			 head = new Node(item);
		     tail = head;
		 } else {
			 Node newNode = new Node(head, item);
		     head = newNode;
		     
		 }
		 count++;
	 }
	 
	 public void addLast(E item) {
		 if (head == null) {
			 head = new Node(item);
		     tail = head;
		 } else {
			 Node newNode = new Node(item, tail);
		     tail = newNode;
		 }
		 count++;
	 }
	 
	 public E remove(int index) {
		 
		 if (index>=count || index<0) {
			 throw new IndexOutOfBoundsException("Invalid index: " + index);
		 }
		 
		 int currentIndex = 0;
		 Node currentNode = head;
		 Node prevNode = null;
		 
		 while (currentIndex < index) {
			 prevNode = currentNode;
		     currentNode = currentNode.right;
		     currentIndex++;
		 }
		 
		 count--;
		 if (count==0) {
			 
			 head = null;
		     tail = null;
		     
		 } else if (prevNode == null) {
			 
			 head = currentNode.right;
			 
		 } else {
			 prevNode.right = currentNode.right;
		 }
		 return currentNode.item;
	 }
	 
	 
}
